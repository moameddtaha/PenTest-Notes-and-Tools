___

# nmblookup






## Description/Overview: 

`nmblookup` is used to query NetBIOS names and map them to IP addresses in a network using NetBIOS over TCP/IP queries. The options allow the name queries to be directed at a particular IP broadcast area or to a particular machine. All queries are done over UDP.

## Features:

-   Name resolution
-   Service enumeration
-   Broadcast mode
-   Workgroup/domain enumeration
-   Integration with other tools

## Options

-   **-A**: This option is used to resolve an IP address to a NetBIOS name.
-   **-B**: This option is used to query all hosts on a subnet for their NetBIOS names (Broadcast).
-   **-R**: This option is used to perform a recursive lookup of a NetBIOS name.
-   **-W**: This option is used to enumerate the workgroups and domains on a network.
-   **-d**: This option is used to specify the debug level of nmblookup.
-   **-v**: This option is used to enable verbose output.
-   **-h**: This option is used to display the help page for nmblookup.
-   **-S**: This option is used to specify the IP address of the name server to use.
-   **-T**: This option is used to specify the number of seconds to wait for a response.
-  **-U**`|--unicast <unicast address>`: Do a unicast query to the specified address or host unicast address. This option (along with the -R option) is needed to query a WINS server.

## Types

-   <20> : Unique name
-   <00> : Workstation/Redirector
-   <03> : Messenger service
-   <01> : Browser service elections
-   <1D> : Domain Master Browser
-   <1E> : Domain Controllers

## Examples:

1.  To resolve the IP address of a host with the NetBIOS name "HOSTNAME", use the following command:

	```ruby
	nmblookup HOSTNAME
	```

2.  To enumerate the services running on a host with the IP address 192.168.1.100, use the following command:

	```ruby
	nmblookup -A 192.168.1.100
	```

3.  To query all hosts on a subnet for their NetBIOS names, use the following command:

	```ruby
	nmblookup -B 192.168.1.255
	```

4.  To enumerate the workgroups and domains on a network, use the following command:

	```ruby
	nmblookup -W
	```

5.  To integrate nmblookup with Nmap, use the following command:


	```ruby
	nmblookup -R -A -v -d 2 - | grep '<00>' | cut -d' ' -f1 | xargs -I {} nmap -sS -p 137 {}
	```

6. nmblookup can be used to query a WINS server (in the same way nslookup is used to query DNS servers). To query a WINS server, 
	nmblookup must be called like this:

	```ruby
	nmblookup -U server -R 'name'
	```

	For example, running :

	```ruby
	nmblookup -U samba.org -R 'IRIX#1B'
	```

	would query the WINS server samba.org for the domain master browser (1B name type) for the IRIX workgroup.


